# MetalLB Configuration for Talos Cluster
controller:
  enabled: true

speaker:
  enabled: true
  # Enable speakerDaemonSet for L2 mode
  tolerations:
  - effect: NoSchedule
    key: node-role.kubernetes.io/control-plane
    operator: Exists
  # Exclude low-memory node that causes OOM/flapping
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: kubernetes.io/hostname
            operator: NotIn
            values:
            - talos-rattypatty

# Prometheus metrics
prometheus:
  serviceMonitor:
    enabled: false

# CRDs are managed separately
crds:
  enabled: true
  validationFailurePolicy: Fail