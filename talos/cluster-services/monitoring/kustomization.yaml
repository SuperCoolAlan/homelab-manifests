apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: monitoring

resources:
- resources/local-asandov-ingresses.yaml

helmCharts:
  - name: kube-prometheus-stack
    repo: https://prometheus-community.github.io/helm-charts
    version: 77.12.0
    releaseName: kube-prometheus-stack
    namespace: monitoring
    valuesFile: values.yaml

patches:
  - path: patches/admission-role-patch.yaml

configMapGenerator:
  # TrueNAS dashboards
  - name: dashboard-truenas-overview
    namespace: monitoring
    options:
      disableNameSuffixHash: true
    files:
      - dashboards/TrueNAS/truenas-overview.json
  - name: dashboard-truenas-app-health
    namespace: monitoring
    options:
      disableNameSuffixHash: true
    files:
      - dashboards/TrueNAS/app-health-overview.json
  - name: dashboard-truenas-disk-insight
    namespace: monitoring
    options:
      disableNameSuffixHash: true
    files:
      - dashboards/TrueNAS/truenas-disk-insight.json
  - name: dashboard-truenas-temperature
    namespace: monitoring
    options:
      disableNameSuffixHash: true
    files:
      - dashboards/TrueNAS/truenas-temperature.json
  - name: dashboard-nvidia-gpu
    namespace: monitoring
    options:
      disableNameSuffixHash: true
    files:
      - dashboards/TrueNAS/nvidia-gpu.json
  - name: dashboard-ups-status
    namespace: monitoring
    options:
      disableNameSuffixHash: true
    files:
      - dashboards/TrueNAS/ups-status.json
  # ArgoCD dashboard
  - name: dashboard-argocd
    namespace: monitoring
    options:
      disableNameSuffixHash: true
    files:
      - dashboards/ArgoCD/argocd-overview.json
  # Traefik dashboard
  - name: dashboard-traefik
    namespace: monitoring
    options:
      disableNameSuffixHash: true
    files:
      - dashboards/Traefik/traefik-official.json
  # Authentik dashboard
  - name: dashboard-authentik
    namespace: monitoring
    options:
      disableNameSuffixHash: true
    files:
      - dashboards/Authentik/authentik.json
  # cert-manager dashboard
  - name: dashboard-cert-manager
    namespace: monitoring
    options:
      disableNameSuffixHash: true
    files:
      - dashboards/CertManager/cert-manager.json
  # Media apps (exportarr) dashboard
  - name: dashboard-exportarr
    namespace: monitoring
    options:
      disableNameSuffixHash: true
    files:
      - dashboards/MediaApps/exportarr.json
