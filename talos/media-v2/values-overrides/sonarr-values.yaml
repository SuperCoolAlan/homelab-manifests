# Inherited from original media deployment
persistentVolumeClaims:
  sonarr-config:
    requestStorage: '10Gi'
    storageClassName: 'nfs'

# Disable config.xml mounting to avoid conflict with NFS volume
application:
  config: null

# Use chart defaults for volume mounts (/config, /downloads, /tv)

# Use specific UID/GID that matches TrueNAS NFS user
deployment:
  container:
    env:
      - name: PUID
        value: "1000"
      - name: PGID
        value: "3001"

# Configure URL base to serve from root
application:
  urlBase: ""
  config:
    contents: |
      <Config>
        <LogLevel>info</LogLevel>
        <EnableSsl>False</EnableSsl>
        <Port>8989</Port>
        <UrlBase></UrlBase>
        <BindAddress>*</BindAddress>
        <ApiKey>$apiKey</ApiKey>
        <AnalyticsEnabled>False</AnalyticsEnabled>
        <AuthenticationMethod>External</AuthenticationMethod>
        <UpdateMechanism>Docker</UpdateMechanism>
        <Branch>master</Branch>
        <InstanceName>Sonarr</InstanceName>
      </Config>

ingress:
  enabled: true
  className: nginx
  host: sonarr.asandov.local
  path: /
  pathType: Prefix
  annotations:
    external-dns.alpha.kubernetes.io/cloudflare-proxied: "true"