# Inherited from original media deployment
persistentVolumeClaims:
  bazarr-config:
    requestStorage: '5Gi'
    storageClassName: 'nfs'

# Disable config.yaml mounting to avoid conflict with NFS volume
application:
  config: null

# Use chart defaults for volume mounts (/config only)

# Use specific UID/GID that matches TrueNAS NFS user
deployment:
  serviceAccountName: media-apps
  nodeSelector:
    kubernetes.io/hostname: talos-flyer
  # Configure volumes to use shared PVCs
  volumes:
    config:
      persistentVolumeClaim:
        claimName: 'bazarr-config'
    downloads:
      persistentVolumeClaim:
        claimName: 'media-downloads'
    media:
      persistentVolumeClaim:
        claimName: 'media-library'
  container:
    env:
      - name: PUID
        value: "1000"
      - name: PGID
        value: "3001"
    volumeMounts:
      - name: config
        mountPath: /config
      - name: downloads
        mountPath: /downloads
      - name: media
        mountPath: /media

ingress:
  enabled: true
  className: traefik
  host: bazarr.asandov.local
  path: /
  pathType: Prefix
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    traefik.ingress.kubernetes.io/router.middlewares: authentik-authentik@kubernetescrd
