# Inherited from original media deployment
persistentVolumeClaims:
  sabnzbd-config:
    requestStorage: '5Gi'
    storageClassName: 'nfs'

# Application configuration with Eweka news server
application:
  config:
    filename: 'sabnzbd.ini'
    contents: |
      [misc]
      language = en
      queue_limit = 20
      port = 8080
      api_key = $apiKey
      nzb_key = $nzbKey
      download_dir = Downloads/incomplete
      complete_dir = Downloads/complete
      host_whitelist =
      auto_browser = 0
      par2_multicore = 1
      folder_rename = 1
      pause_on_pwrar = 1
      ignore_samples = 1
      deobfuscate_final_filenames = 1
      direct_unpack = 1
      history_retention = 0
      enable_recursive = 1
      
      [servers]
      [[news.eweka.nl]]
      name = news.eweka.nl
      displayname = Eweka
      host = news.eweka.nl
      port = 563
      username = 48ef10df07d993e3
      password = $ewekaPassword
      connections = 50
      ssl = 1
      ssl_verify = 2
      enable = 1
      priority = 0
      
      [[news.newshosting.com]]
      name = news.newshosting.com
      displayname = Newshosting
      host = news.newshosting.com
      port = 563
      username = olgavcy7wc
      password = $newshostingPassword
      connections = 100
      ssl = 1
      ssl_verify = 2
      enable = 1
      priority = 1
      
      [categories]
      [[*]]
      name = *
      order = 0
      pp = 3
      script = None
      dir = 
      newzbin = 
      priority = 0
    secrets: [ 'apiKey', 'nzbKey', 'ewekaPassword', 'newshostingPassword' ]

# Extra environment variables to inject the passwords from secret
deployment:
  container:
    env:
      - name: PUID
        value: "1000"
      - name: PGID
        value: "1000"
      - name: 'ewekaPassword'
        valueFrom:
          secretKeyRef:
            name: sabnzbd
            key: ewekaPassword
      - name: 'newshostingPassword'
        valueFrom:
          secretKeyRef:
            name: sabnzbd
            key: newshostingPassword

# Use chart defaults for volume mounts

ingress:
  enabled: true
  className: nginx
  host: sabnzbd.asandov.local
  path: /
  pathType: Prefix
  annotations:
    external-dns.alpha.kubernetes.io/hostname: sabnzbd.asandov.local